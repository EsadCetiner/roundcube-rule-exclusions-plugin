# ----------------------------------------------------------------------------------------------
# roundcube rule exclusions plugin
# Copyright (c) 2023-2025 Esad Cetiner
#
# This plugin is distributed under GPLv2
# Please see the included LICENSE file for full details
# ----------------------------------------------------------------------------------------------

# Plugin name: roundcube-rule-exclusions-plugin
# Plugin description: OWASP CRS 3rd party plugin for Roundcube webmail
# Rule ID block base: 9,519,000 - 9,519,999
# Plugin version: 1.0.3

# See readme.md for documentation

# Generic rule to disable plugin
SecRule TX:roundcube-rule-exclusions-plugin "@eq 0" "id:9519010,phase:1,pass,nolog,ctl:ruleRemoveById=9519100-9519999"

# Apply rule exclusions to all URL paths by default
SecRule &TX:roundcube-rule-exclusions-path "@eq 0" "id:9519011,phase:1,pass,nolog,setvar:'tx.roundcube-rule-exclusions-path=/'"

#
# [ Local CRS initialization ]
#
# We need to initialize some of the CRS variables also here because plugin setup runs before
# CRS initialization (this is a known limitation of the current plugin architecture). Must be
# kept in sync with CRS default setting.

# Copy of CRS rule 901162.
SecRule &TX:allowed_request_content_type "@eq 0" \
    "id:9519020,\
    phase:1,\
    pass,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    setvar:'tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |text/xml| |application/xml| |application/soap+xml| |application/json| |application/reports+json| |application/csp-report|'"

# Roundcube sends all requests to the same URL path (Depending on the HTTP server configuration) this plugin avoids grouping all
# rule exclusions into one rule for improved readability.

# Fix RoundCube cookie false positive
# Cookies are always sent regardless of the URL path
SecRule REQUEST_FILENAME "@unconditionalMatch" \
    "id:9519100,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=932236;REQUEST_COOKIES:roundcube_sessid,\
    ctl:ruleRemoveTargetById=932236;REQUEST_COOKIES:roundcube_sessauth,\
    ctl:ruleRemoveTargetById=932236;REQUEST_COOKIES_NAMES:identviewsplitter,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES:roundcube_sessid,\
    ctl:ruleRemoveTargetById=942450;REQUEST_COOKIES:roundcube_sessauth,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3'"

# Logging into roundcube
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519101,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq login" \
        "t:none,\
        ctl:ruleRemoveTargetById=920273;ARGS:_timezone,\
        ctl:ruleRemoveTargetById=920273;ARGS:_user,\
        ctl:ruleRemoveTargetById=932235;ARGS:_url,\
        ctl:ruleRemoveTargetById=932236;ARGS:_url,\
        ctl:ruleRemoveTargetById=942432;ARGS:_url,\
        ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_action,\
        ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_framed,\
        ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_task,\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_pass"

# Keywords like settings and mail frequently appear in the referrer header when doing pretty much anything
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519102,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule REQUEST_HEADERS:referer "@rx ^https://.+/\?_task=(?:mail|settings|logout&_token=[a-zA-Z0-9]+$)" \
        "t:none,\
        ctl:ruleRemoveTargetById=932237;REQUEST_HEADERS:referer,\
        ctl:ruleRemoveTargetById=932239;REQUEST_HEADERS:referer"

# Handle false positives with randomly generated tokens within character range a-z A-Z 0-9
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519104,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_token "@rx ^[a-zA-Z0-9]+$" \
        "t:none,\
        ctl:ruleRemoveTargetById=932236;ARGS:_token,\
        ctl:ruleRemoveTargetById=942450;ARGS:_token"

#
# [ Mailbox ]
#

# When viewing emails
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519110,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=920272;REQUEST_BODY,\
    ctl:ruleRemoveTargetById=920273;REQUEST_BODY,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3'"

# Opening an mailbox
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519111,\
    phase:4,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule RESPONSE_BODY "@rx maximum allowed file size is [0-9]+ [kmg]b" \
        "t:none,\
        t:lowercase,\
        ctl:ruleRemoveById=953101"

# The content of an email can be anything
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519112,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq mail" \
        "t:none,\
        chain"
        SecRule REQUEST_METHOD "@streq GET" \
            "t:none,\
            ctl:ruleRemoveById=951220,\
            ctl:ruleRemoveById=951230"

# _framed paramater is sent twice when viewing email headers
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519113,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq mail" \
        "t:none,\
        chain"
        SecRule &ARGS:_framed "@eq 2" \
            "t:none,\
            ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_framed"

# Composing an email
# Composing an email in a new window
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519114,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq mail" \
        "t:none,\
        chain"
        SecRule ARGS:_action "@rx ^(?:send|compose)$" \
            "t:none,\
            ctl:ruleRemoveTargetById=921110;REQUEST_BODY,\
            ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_id,\
            ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_framed,\
            ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_task,\
            ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_action,\
            ctl:ruleRemoveTargetById=920273;ARGS:_to,\
            ctl:ruleRemoveTargetById=942131;ARGS:_to,\
            ctl:ruleRemoveTargetById=942432;ARGS:_to,\
            ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_subject,\
            ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_message"

# Creating an email/signature in HTML mode
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519115,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq utils" \
        "t:none,\
        chain"
        SecRule ARGS:_action "@rx ^(?:text2html|html2text)$" \
            "t:none,\
            setvar:'tx.allowed_request_content_type=%{tx.allowed_request_content_type} |application/octet-stream|'"

# Creating a new sieve filter from an email
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519116,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule REQUEST_HEADERS:referer "@rx ^https://.+/\?_task=mail&_action=plugin\.managesieve&_framed=1&r\[[0-9]+\]=" \
        "t:none,\
        ctl:ruleRemoveTargetById=932131;REQUEST_HEADERS:referer"

#
# [ Addressbook ]
#

# Creating/modifying/searching contacts
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519130,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq addressbook" \
        "t:none,\
        ctl:ruleRemoveTargetById=920273;ARGS:_im[],\
        ctl:ruleRemoveTargetById=931130;ARGS:_im[],\
        ctl:ruleRemoveTargetById=942432;ARGS:_photo,\
        ctl:ruleRemoveTargetById=931130;ARGS:_search_im,\
        ctl:ruleRemoveTargetById=931130;ARGS:_search_website,\
        ctl:ruleRemoveTargetById=931130;ARGS:_website[],\
        ctl:ruleRemoveTargetById=920273;ARGS:_website[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_country[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_country[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_country[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_email[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_email[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_email[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_im[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_im[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_im[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_locality[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_locality[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_locality[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_phone[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_phone[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_phone[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_region[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_region[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_region[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_street[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_street[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_street[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_subtype_address[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_subtype_address[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_subtype_address[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_subtype_email[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_subtype_email[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_subtype_email[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_subtype_im[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_subtype_im[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_subtype_im[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_subtype_phone[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_subtype_phone[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_subtype_phone[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_subtype_website[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_subtype_website[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_subtype_website[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_website[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_website[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_website[],\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES:_zipcode[],\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES:_zipcode[],\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES:_zipcode[],\
        ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_framed,\
        ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_task"

#
# [ Settings ]
#

# Creating signatures
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519150,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=920273;ARGS:_email,\
    ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_signature,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3'"

# Creating/editing/deleting identities
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519151,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_action "@streq identities" \
        "t:none,\
        ctl:ruleRemoveTargetById=932236;ARGS:_action"

# Changing email address password
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519152,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq settings" \
        "t:none,\
        chain"
        SecRule ARGS:_action "@streq plugin.password-save" \
            "t:none,\
            ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_curpasswd,\
            ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_newpasswd,\
            ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_confpasswd"

# Creating/modifying an sieve filter
# The number in `_rule_target[0]` parameter keeps on changing and regular expressions are not supported for targets,
# for now I've gone up to 100 which should cover most use cases.
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519153,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq settings" \
        "t:none,\
        ctl:ruleRemoveTargetById=920273;ARGS_NAMES,\
        ctl:ruleRemoveTargetById=921220;ARGS_NAMES,\
        ctl:ruleRemoveTargetById=942432;ARGS_NAMES,\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[0][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[1][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[2][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[3][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[4][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[5][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[6][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[7][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[8][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[9][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[10][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[11][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[12][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[13][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[14][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[15][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[16][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[17][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[18][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[19][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[20][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[21][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[22][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[23][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[24][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[25][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[26][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[27][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[28][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[29][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[30][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[31][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[32][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[33][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[34][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[35][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[36][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[37][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[38][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[39][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[40][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[41][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[42][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[43][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[44][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[45][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[46][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[47][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[48][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[49][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[50][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[51][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[52][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[53][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[54][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[55][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[56][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[57][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[58][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[59][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[60][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[61][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[62][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[63][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[64][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[65][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[66][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[67][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[68][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[69][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[70][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[71][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[72][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[73][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[74][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[75][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[76][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[77][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[78][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[79][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[80][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[81][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[82][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[83][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[84][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[85][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[86][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[87][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[88][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[89][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[90][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[91][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[92][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[93][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[94][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[95][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[96][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[97][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[98][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[99][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_rule_target[100][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:_custom_var[0][],\
        ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:rawsetcontent"

# Creating/modifying an out of office reply
SecRule REQUEST_FILENAME "@beginsWith %{tx.roundcube-rule-exclusions-path}" \
    "id:9519156,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ver:'roundcube-rule-exclusions-plugin/1.0.3',\
    chain"
    SecRule ARGS:_task "@streq settings" \
        "t:none,\
        chain"
        SecRule ARGS:_action "@streq plugin.managesieve-vacation" \
            "t:none,\
            ctl:ruleRemoveTargetById=920273;ARGS:vacation_addresses[],\
            ctl:ruleRemoveTargetById=920273;ARGS:vacation_datefrom,\
            ctl:ruleRemoveTargetById=920273;ARGS:vacation_dateto,\
            ctl:ruleRemoveTargetById=920273;ARGS:vacation_from,\
            ctl:ruleRemoveTargetById=920273;ARGS_NAMES:vacation_addresses[],\
            ctl:ruleRemoveTargetById=921220;ARGS_NAMES:vacation_addresses[],\
            ctl:ruleRemoveTargetById=942432;ARGS_NAMES:vacation_addresses[],\
            ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_action,\
            ctl:ruleRemoveTargetById=921180;TX:paramcounter_ARGS_NAMES:_task,\
            ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:vacation_reason,\
            ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:vacation_subject"
